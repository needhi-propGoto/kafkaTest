// consumer.js
const { Kafka } = require('kafkajs');

async function consume() {
    const kafka = new Kafka({
        clientId: 'my-node-app',
        brokers: ['localhost:9092'], // Connect to local Kafka broker
    });

    const consumer = kafka.consumer({ groupId: 'my-consumer-group' }); // Consumer group name

    try {
        // Connect to the consumer
        await consumer.connect();
        console.log('Consumer connected!');

        // Subscribe to the topic 'my-topic'
        await consumer.subscribe({ topic: 'my-first-topic', fromBeginning: true });

        // Consume messages from the topic
        await consumer.run({
            eachMessage: async ({ topic, partition, message }) => {
                console.log(`Received message: ${message.value.toString()}`);
            },
        });
    } catch (error) {
        console.error('Error consuming message:', error);
    }
}

consume().catch(console.error);
